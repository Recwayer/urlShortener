# Сервис сокращения ссылок
Java-приложение для создания и управления короткими ссылками с ограничением по времени и количеству переходов.

# Функциональность
- Создание уникальных коротких ссылок для каждого пользователя
- Ограничение максимального количества переходов
- Автоматическое истечение срока действия ссылок
- Уведомления о статусе ссылок
- Управление ссылками
- Многопользовательский режим с UUID-идентификацией
- Консольный интерфейс

# Требования
- Java 17 или выше
- Gradle 8.6+

## Установка и запуск
Клонируйте репозиторий:
```shell
git clone https://github.com/Recwayer/urlShortener.git
cd urlShortener
```
Запустите приложение:
```shell
./gradlew run
```
Или соберите JAR и запустите:
```shell
./gradlew jar
java -jar build/libs/urlShortener-1.0.0.jar
```
# Использование
После запуска приложения доступно меню с следующими опциями:
- Создать короткую ссылку
- Перейти по короткой ссылке
- Мои ссылки
- Редактировать ссылку
- Удалить ссылку
- Сменить пользователя
- Выход

## Создание короткой ссылки
1. Выберите пункт "1. Создать короткую ссылку"
2. Введите длинную ссылку
3. Укажите максимальное количество переходов
4. Получите короткую ссылку

## Переход по ссылке
1. Выберите пункт "2. Перейти по короткой ссылке"
2. Введите короткий код ссылки
3. Ссылка автоматически откроется в браузере

## Просмотр своих ссылок
1. Выберите пункт "3. Мои ссылки"
2. Система покажет список всех созданных ссылок с детальной информацией

## Редактирование ссылки
1. Выберите пункт "4. Редактировать ссылку"
2. Выберите ссылку из списка по номеру
3. Введите новое значение максимального количества переходов
4. Система обновит ссылку

## Удаление ссылки
1. Выберите пункт "5. Удалить ссылку"
2. Выберите ссылку из списка по номеру
3. Подтвердите удаление
4. Ссылка будет полностью удалена из системы

## Смена пользователя
1. Выберите пункт "6. Сменить пользователя"
2. Введите существующий User ID или оставьте пустым для создания нового
3. Система переключит контекст на выбранного пользователя

# Конфигурация
Настройки приложения в файле `src/main/resources/application.properties`:
```
# Базовый URL для коротких ссылок
# Формат: любой валидный URL с или без завершающего слеша
# Примеры: clck.ru/, localhost:8080/
app.short-link.base-url=http://clck.ru/
# Время жизни ссылок по умолчанию
# Формат: PT{часы}H{минуты}M{секунды}S
# Примеры:
#   PT24H    - 24 часа
#   PT1H30M  - 1 час 30 минут
#   PT5M     - 5 минут
app.short-link.default-ttl=PT24H
# Максимальное количество переходов по умолчанию
app.short-link.default-max-clicks=100
# Интервал автоматической очистки просроченных ссылок (в миллисекундах)
app.cleanup.interval-ms=3600000
```

# Особенности реализации
- Гарантированная уникальность: Каждый пользователь получает уникальные короткие ссылки даже для одинаковых URL
- Автоматическое обслуживание: Фоновая очистка просроченных ссылок
- Безопасность: UUID-идентификация и проверка прав доступа
- Масштабируемость: In-memory хранилище с возможностью замены на БД
- Конфигурируемость: Гибкие настройки через properties-файл

# Архитектура и решения
## Структура проекта
```
domain/ - Доменные модели
    User - Модель пользователя
    ShortLink - Модель короткой ссылки
repository/ - Слой данных
    LinkRepository - Интерфейс репозитория ссылок
    ShortLinkRepositoryImpl - In-memory реализация
    UserRepository - Интерфейс репозитория пользователей
    UserRepositoryImpl - In-memory реализация
service/ - Бизнес-логика
    LinkService - Интерфейс сервиса ссылок
    ShortLinkServiceImpl - Реализация сервиса ссылок
    UserService - Интерфейс сервиса пользователей
    UserServiceImpl - Реализация сервиса пользователей
    Notifier - Интерфейс уведомлений
    NotificationService - Консольная реализация
    CleanupService - Сервис очистки устаревших ссылок
controller/ - UI-слой
    ConsoleController - Консольный UI
util/ - Вспомогательные утилиты
    UrlValidator - Валидатор URL
    ShortCodeGenerator - Генератор коротких кодов для ссылок
config/ - Конфигурация
    AppConfig - Properties-конфигурация для приложения
```

Слоистая архитектура:
- Domain - чистые модели данных 
- Repository - абстракция доступа к данным
- Service - бизнес-логика и правила
- Controller - взаимодействие с пользователем

# Тестирование
Запуск тестов
```shell
./gradlew test
```
Всего: 38 тестов

## Ключевые тестовые сценарии
- Валидация URL
- Уникальность коротких кодов для разных пользователей
- Ограничение переходов и блокировка ссылок
- Многопользовательская изоляция данных
- Уведомления о статусе ссылок
